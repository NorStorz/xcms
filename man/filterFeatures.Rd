% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/method-filterFeatures.R
\name{filterFeatures}
\alias{filterFeatures}
\title{Filtering of features based on conventional quality assessment}
\arguments{
\item{object}{\code{XcmsExperiment} or \code{SummarizedExperiment}. For an
\code{XcmsExperiment} object, the \code{featureValues(object)} will be evaluated, and
for \code{Summarizedesxperiment} the \code{assay(object, assay)}. The object will be
filtered.}

\item{filter}{The parameter object selecting and configuring the type of
filtering. It can be one of the following classes: \code{\link{RsdFilter}},
\code{\link{DratioFilter}}, \code{\link{PercentMissingFilter}} or \code{\link{BlankFlag}}.}

\item{assay}{For filtering of \code{SummarizedExperiment} objects only. Indicates
which assay the filtering will be based on. Note that the features for the
entire object will be removed, but the computations are performed on a single
assay. Default is 1, which mean the first assay of the \code{object} will
be evaluated.}

\item{...}{Optional parameters.}
}
\description{
When dealing with metabolomics results, it is often necessary to filter
features based on certain criteria. These criteria are typically derived
from statistical formulas applied to full rows of data, where each row
represents a feature.
The \code{filterFeatures} function filters features based on these conventional
quality assessment criteria. Multiple type of filtering are implemented and\
can be defined by the \code{filter} argument.

Supported \code{filter} arguments are:
\itemize{
\item \code{\link{RsdFilter}}: Calculates the relative standard deviation
(i.e. coefficient of variation) of each features in QC (Quality Control)
samples and filter them in the input object according to a provided
threshold.
\item \code{\link{DratioFilter}}: Computes the D-ratio or \emph{dispersion ratio}, defined as
the standard deviation for QC samples divided by the standard deviation for
biological test samples, for each features and filter them according to a
provided threshold
\item \code{\link{PercentMissingFilter}}: Determine the percentage of missing values for
each features in  and filters them according to a provided threshold.
\item \code{\link{BlankFlag}}: Identifies features where the mean of test samples
is lower than a specified multiple of the mean of blank samples. This can
be used to flag features that result from contamination in the solvent of
the samples. A new column \code{possible_contaminant} is added to the
\code{featureDefinitions} reflecting this.
}

For specific examples, see the help pages of the individual parameter classes
listed above.
}
\examples{
## See the vignettes for more detailed examples

## Load a test data set with features
test_xcms <- loadXcmsData()

## Set up parameter to filter based on coefficient of variation
rsd_filter <- RsdFilter(qcIndex = sampleData(test_xcms)$sample_type == "QC")

filtered_data_rsd <- filterFeatures(object = test_xcms, filter = rsd_filter)

## Set up parameter to filter based on D-ratio and filter
dratio_filter <- DratioFilter(qcIndex = sampleData(test_xcms)$sample_type == "QC",
                              studyIndex = sampleData(test_xcms)$sample_type == "study")

filtered_data_dratio <- filterFeatures(object = test_xcms,
filter = dratio_filter)

## Set up parameter to filter based on the percent of missing data
missing_data_filter <- PercentMissingFilter(f = sampleData(test_xcms)$sample_type)

filtered_data_missing <- filterFeatures(object = test_xcms,
filter = missing_data_filter)

## Set up parameter to flag possible contaminant based on blank samples
filter <- BlankFlag(
    qcIndex = sampleData(test_xcms)$sample_type == "QC",
    blankIndex = sampleData(test_xcms)$sample_type == "study")
filtered_xmse <- filterFeatures(test_xcms, filter)

}
\references{
Broadhurst D, Goodacre R, Reinke SN, Kuligowski J, Wilson ID, Lewis MR,
Dunn WB. Guidelines and considerations for the use of system suitability
and quality control samples in mass spectrometry assays applied in
untargeted clinical metabolomic studies. Metabolomics. 2018;14(6):72.
doi: 10.1007/s11306-018-1367-3. Epub 2018 May 18. PMID: 29805336;
PMCID: PMC5960010.
}
\author{
Philippine Louail
}
