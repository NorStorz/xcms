% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/DataClasses.R,
%   R/XcmsExperiment.R, R/functions-Params.R, R/methods-Params.R,
%   R/methods-XCMSnExp.R
\docType{class}
\name{groupChromPeaks}
\alias{groupChromPeaks}
\alias{PeakDensityParam-class}
\alias{groupChromPeaks,XcmsExperiment,Param-method}
\alias{PeakDensityParam}
\alias{sampleGroups,PeakDensityParam-method}
\alias{sampleGroups}
\alias{sampleGroups<-,PeakDensityParam-method}
\alias{sampleGroups<-}
\alias{bw,PeakDensityParam-method}
\alias{bw}
\alias{bw<-,PeakDensityParam-method}
\alias{bw<-}
\alias{minFraction,PeakDensityParam-method}
\alias{minFraction}
\alias{minFraction<-,PeakDensityParam-method}
\alias{minFraction<-}
\alias{minSamples,PeakDensityParam-method}
\alias{minSamples}
\alias{minSamples<-,PeakDensityParam-method}
\alias{minSamples<-}
\alias{binSize,PeakDensityParam-method}
\alias{binSize<-,PeakDensityParam-method}
\alias{maxFeatures,PeakDensityParam-method}
\alias{maxFeatures}
\alias{maxFeatures<-,PeakDensityParam-method}
\alias{maxFeatures<-}
\alias{groupChromPeaks,XCMSnExp,PeakDensityParam-method}
\title{Correspondence: group chromatographic peaks across samples}
\usage{
groupChromPeaks(object, param, ...)

\S4method{groupChromPeaks}{XcmsExperiment,Param}(object, param, msLevel = 1L, add = FALSE)

PeakDensityParam(
  sampleGroups = numeric(),
  bw = 30,
  minFraction = 0.5,
  minSamples = 1,
  binSize = 0.25,
  maxFeatures = 50
)

\S4method{sampleGroups}{PeakDensityParam}(object)

\S4method{sampleGroups}{PeakDensityParam}(object) <- value

\S4method{bw}{PeakDensityParam}(object)

\S4method{bw}{PeakDensityParam}(object) <- value

\S4method{minFraction}{PeakDensityParam}(object)

\S4method{minFraction}{PeakDensityParam}(object) <- value

\S4method{minSamples}{PeakDensityParam}(object)

\S4method{minSamples}{PeakDensityParam}(object) <- value

\S4method{binSize}{PeakDensityParam}(object)

\S4method{binSize}{PeakDensityParam}(object) <- value

\S4method{maxFeatures}{PeakDensityParam}(object)

\S4method{maxFeatures}{PeakDensityParam}(object) <- value

\S4method{groupChromPeaks}{XCMSnExp,PeakDensityParam}(object, param, msLevel = 1L, add = FALSE)
}
\arguments{
\item{object}{The data object on which the correspondence analysis should be
performed. Can be an \code{\link[=XCMSnExp]{XCMSnExp()}}, \code{\link[=XcmsExperiment]{XcmsExperiment()}} object.}

\item{param}{The parameter object selecting and configuring the algorithm.}

\item{...}{Optional parameters.}

\item{msLevel}{\code{integer(1)} defining the MS level on which the
chromatographic peak detection should be performed.}

\item{add}{\code{logical(1)} (if \code{object} contains already chromatographic peaks,
i.e. is either an \code{XCMSnExp} or \code{XcmsExperiment}) whether chromatographic
peak detection results should be \strong{added} to existing results. By
default (\code{add = FALSE}) any additional \code{findChromPeaks} call on a result
object will remove previous results.}

\item{sampleGroups}{For \code{PeakDensityParam}: A vector of the same length than
samples defining the sample group assignments (i.e. which samples
belong to which sample
group). This parameter is mandatory for the \code{PeakDensityParam}
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).}

\item{bw}{For \code{PeakDensityParam}: \code{numeric(1)} defining the bandwidth
(standard deviation ot the smoothing kernel) to be used. This argument
is passed to the [density() method.}

\item{minFraction}{For \code{PeakDensityParam}: \code{numeric(1)} defining the minimum
fraction of samples in at least one sample group in which the peaks
have to be present to be considered as a peak group (feature).}

\item{minSamples}{For \code{PeakDensityParam}: \code{numeric(1)} with the minimum
number of samples in at least one sample group in which the peaks have
to be detected to be considered a peak group (feature).}

\item{binSize}{For \code{PeakDensityParam}: \code{numeric(1)} defining the size of the
overlapping slices in m/z dimension.}

\item{maxFeatures}{For \code{PeakDensityParam}: \code{numeric(1)} with the maximum
number of peak groups to be identified in a single mz slice.}

\item{value}{Replacement value for \verb{<-} methods.}
}
\value{
For \code{groupChromPeaks}: either an \code{\link[=XcmsExperiment]{XcmsExperiment()}} or \code{\link[=XCMSnExp]{XCMSnExp()}}
object with the correspondence result.
}
\description{
The \code{groupChromPeaks} method performs a correspondence analysis i.e., it
groups chromatographic peaks across samples to define the LC-MS \emph{features}.
The correspondence algorithm can be selected, and configured, using the
\code{param} argument. See documentation of \code{\link[=XcmsExperiment]{XcmsExperiment()}} and \code{\link[=XCMSnExp]{XCMSnExp()}}
for information on how to access and extract correspondence results.

Supported \code{param} objects are:
\itemize{
\item \code{\link[=PeakDensityParam]{PeakDensityParam()}}: correspondence using the \emph{peak density} method
(Smith 2006) that groups chromatographic peaks along the retention time
axis within slices of (partially overlapping) m/z ranges. All peaks (from
the same or from different samples) with their apex position being close
on the retention time axis are grouped into a LC-MS feature. See in
addition \code{\link[=do_groupChromPeaks_density]{do_groupChromPeaks_density()}} for the base correspondence
function.
\item \code{\link[=MzClustParam]{MzClustParam()}}: performs high resolution peak grouping for
\strong{single spectrum} metabolomics data. This method should \strong{only} be used
for such data as the retention time is not considered in the correspondence
analysis.
}

For specific examples and description of the method and settings see the
help pages of the individual parameter classes listed above.
}
\references{
Smith, C.A., Want E.J., O'Maille G., Abagyan R., and Siuzdak G. (2006)
"XCMS: Processing Mass Spectrometry Data for Metabolite Profiling Using
Nonlinear Peak Alignment, Matching, and Identification" \emph{Anal. Chem.}
78:779-787.
}
\seealso{
Other peak grouping methods: 
\code{\link{groupChromPeaks-mzClust}},
\code{\link{groupChromPeaks-nearest}}
}
\author{
Colin Smith, Johannes Rainer
}
\concept{peak grouping methods}
